<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Documentación - Proyecto Reporte de Incidencias</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding-top: 60px; }
    .nav-link { cursor: pointer; }
    pre { background: #f8f9fa; padding: 10px; border-radius: 5px; }
  </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  <div class="container">
    <a class="navbar-brand" href="#">Doc Proyecto Incidencias</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="#objetivo">Objetivo</a></li>
        <li class="nav-item"><a class="nav-link" href="#funcionalidades">Funcionalidades</a></li>
        <li class="nav-item"><a class="nav-link" href="#usuarios">Usuarios</a></li>
        <li class="nav-item"><a class="nav-link" href="#tablas">Tablas DB</a></li>
        <li class="nav-item"><a class="nav-link" href="#rutas">Rutas</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
  <section id="objetivo" class="mb-5">
    <h2>Objetivo del Proyecto</h2>
    <p>Desarrollar una aplicación web en PHP y MySQL que permita registrar, visualizar y gestionar incidencias ocurridas en el país, utilizando mapas, formularios y autenticación de usuarios.</p>
  </section>

  <section id="funcionalidades" class="mb-5">
    <h2>Funcionalidades Principales</h2>
    <ul>
      <li><strong>Registro de Incidencias:</strong> fecha, título, tipo(s), descripción, ubicación, muertos, heridos, pérdidas, fotos y link a redes sociales.</li>
      <li><strong>Visualización en el Mapa:</strong> íconos por tipo, clustering, click para ver detalle en modal o página.</li>
      <li><strong>Acciones desde el Detalle:</strong> comentarios de usuarios y sugerencias de corrección (validadas por /super).</li>
      <li><strong>Filtros y Búsqueda:</strong> por provincia, tipo de incidencia, rango de fechas y título.</li>
      <li><strong>Vista Alterna:</strong> lista de incidencias con detalle y mapa.</li>
      <li><strong>Panel /super:</strong> validación de reportes, estadísticas dinámicas y gestión de catálogos (provincias, municipios, barrios, tipos de incidencias).</li>
    </ul>
  </section>

  <section id="usuarios" class="mb-5">
    <h2>Usuarios y Roles</h2>
    <table class="table table-bordered">
      <thead class="table-light">
        <tr>
          <th>Tipo</th>
          <th>Email de prueba</th>
          <th>Contraseña</th>
          <th>Acceso</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Reportero</td>
          <td>reportero@example.com</td>
          <td>Admin123*</td>
          <td>/login</td>
        </tr>
        <tr>
          <td>Validador</td>
          <td>super@example.com</td>
          <td>Admin123*</td>
          <td>/super-login</td>
        </tr>
        <tr>
          <td>Administrador</td>
          <td>admin@example.com</td>
          <td>Admin123*</td>
          <td>/super-login</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="tablas" class="mb-5">
    <h2>Tablas de la Base de Datos</h2>
    <h5>roles</h5>
    <pre>
CREATE TABLE roles (
  id TINYINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(20) UNIQUE NOT NULL
);

INSERT INTO roles (name) VALUES ('reportero'), ('validador'), ('admin');
    </pre>

    <h5>users</h5>
    <pre>
CREATE TABLE users (
  id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(120) NOT NULL,
  email VARCHAR(180) UNIQUE,
  password_hash VARCHAR(255),
  role_id TINYINT UNSIGNED NOT NULL DEFAULT 1,
  status ENUM('active','blocked') NOT NULL DEFAULT 'active',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (role_id) REFERENCES roles(id)
);
    </pre>
  </section>

  <section id="rutas" class="mb-5">
    <h2>Rutas / Archivos Clave</h2>
    <ul>
      <li><strong>/login.php</strong> → Ingreso de reporteros.</li>
      <li><strong>/super-login.php</strong> → Ingreso de validadores y administradores.</li>
      <li><strong>/lista.php</strong> → Lista de incidencias con filtros.</li>
      <li><strong>/detalle.php</strong> → Detalle de cada incidencia con mapa, comentarios y correcciones.</li>
      <li><strong>/super-dashboard.php</strong> → Panel de administración de catálogos y estadísticas.</li>
      <li><strong>/layout.php</strong> → Plantilla general de diseño.</li>
      <li><strong>/src/db.php</strong> → Conexión a la base de datos.</li>
      <li><strong>/src/helpers.php</strong> → Funciones auxiliares (escape, csrf, redirect).</li>
      <li><strong>/src/auth.php</strong> → Gestión de sesiones y login/logout.</li>
    </ul>
  </section>

  <footer class="mt-5 mb-3 text-center text-muted">
    &copy; 2025 Proyecto Reporte de Incidencias - Documentación
  </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
